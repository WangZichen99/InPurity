from typing import Dict

_translations: Dict[str, Dict[str, str]] = {
        'en': {
            # mainservice
            "MAIN_SVC_START": "Main service is starting",
            "MITMPROXY_TERMINATED": "The process of mitmproxy have terminated, restarting",
            "SVC_STOP_SIGNAL": "Received service stop signal",
            "ILLEGAL_STOP": "Illegal stop",
            "MAIN_SVC_STOPPING": "Stopping main service...",
            "SVC_SETTINGS_CHANGED": "Service settings change detected, new value: {}",
            "KEY_TAMPERED": "{} has been tampered with, correcting...",
            "KEY_CORRECTED": "{} correction completed",
            "SVC_CORRECTION_ERROR": "Error correcting service settings: {}",
            "FORCE_CONFIG_REFRESH_FAIL": "Failed to force refresh service configuration: {}",
            "SERVICE_RECOVERY_SUCCESS": "Service recovery options set successfully",
            "DAEMON_CONFIG_FAIL": "Failed to get daemon service configuration: {}",
            "SOCKET_LISTEN_START": "Starting socket listening thread",
            "MITMPROXY_RESTART": "Received restart command, restarting mitmproxy",
            "REMOTE_CONN_CLOSED": "Remote connection closed",
            "SOCKET_LISTEN_ERROR": "Socket listening error: {}",
            "SOCKET_THREAD_STOPPED": "Socket listening thread stopped",
            "SOCKET_CLOSE_ERROR": "Error occurred while closing socket: {}",
            "SOCKET_STOP_ERROR": "Error occurred while stopping socket listener: {}",
            "PROXY_PORT_GET": "Getting proxy port: {}",
            "PROXY_PORT_CHECK": "Please set proxy port and verify availability",
            "UPSTREAM_PROXY_STATUS": "Getting upstream proxy status: {}",
            "ENABLE": "enable",
            "DISABLE": "disable",
            "UPSTREAM_PROXY_ADDRESS": "Getting upstream proxy server address: {}",
            "UPSTREAM_PROXY_REQUIRED": "Please set upstream proxy server address first",
            "PROXY_CONFIG_GET": "Getting proxy configuration: {}",
            "PORT_AVAILABLE": "Port {} is available",
            "PORT_UNAVAILABLE": "Port {} is unavailable: {}",
            "WIN_PROXY_SET": "Setting Windows proxy: ProxyEnable={}, ProxyServer={}",
            "WIN_PROXY_ERROR": "Error setting Windows proxy: {}",
            "EXECUTE_COMMAND": "Executing command: {}",
            "MITMDUMP_START_SUCCESS": "mitmdump started successfully, port: {}, upstream proxy: {}, upstream server: {}",
            "MITMDUMP_START_FAIL": "mitmdump failed to start",
            "COMMAND_EXEC_ERROR": "Error executing command: {}",
            "MITMPROXY_STOPPING": "Stopping mitmproxy process...",
            "FORCE_KILL_PROCESS": "Force killing mitmproxy process after timeout",
            "MITMPROXY_STOPPED": "mitmproxy process and related threads stopped",
            "PROCESS_NOT_STOPPED": "{} not stopped",
            "TERMINATE_PROCESS": "Terminating process: {} (PID: {})",
            "MITMPROXY_TERM_ERROR": "Error terminating mitmproxy process: {}",
            "ERROR": "An error occurred: {}",
            "DAEMON_SVC_RESTART_ATTEMPT": "Daemon service has been stopped, attempting restart",
            "DAEMON_SVC_RESTARTED": "Daemon service has been restarted",
            "MONITOR_DAEMON_END": "The thread of daemon service monitor has stoped",
            "SYSTEM_SHUTDOWN_WARNING": "System shutdown",
            "SUCCESS_LAUNCHED": "Successfully launched GUI process. PID: {}",
            "NO_USER_CONTEXT": "No user process found for current session",
            "FAILED_LAUNCH": "Failed to launch GUI process: {}",
            "FAILED_USER_CONTEXT": "Failed to get user PID: {}",  
            "MAX_WAIT_EXCEEDED": "Maximum wait time exceeded (10 minutes) when getting user PID", 
            "SESSION_NOT_ACTIVE": "Process ID {} is not the active session", 
            "CONFIG_CONVERT_ERROR": "Error converting configuration item {}: {}",
            "THREAD_STARTED": "Thread {} started",
            "THREAD_STOP_TIMEOUT": "Thread {} did not terminate within timeout",       

            # pipe management
            "PIPE_CREATED": "Named pipe created successfully",
            "WAITING_FOR_PIPE": "Waiting for GUI pipe to be available",
            "PIPE_CREATE_ERROR": "Error creating pipe: {}",
            "GUI_PIPE_CLOSED": "GUI pipe closed successfully",
            "GUI_PIPE_CLOSE_ERROR": "Error closing GUI pipe: {}",
            "GUI_PROCESS_CLOSED": "GUI process closed successfully",
            "GUI_PROCESS_CLOSE_ERROR": "Error closing GUI process: {}",
            "GUI_LAUNCH_FAILED_RETRY": "GUI launch failed, retry {}/{} in progress",
            "PIPE_CONNECT_TIMEOUT": "Timeout connecting to GUI pipe",
            "GUI_PIPE_ABANDONED": "Abandoned GUI pipe connection after maximum retries",
            "GUI_PIPE_ERROR": "Error in GUI pipe management: {}",
            "GUI_PIPE_WRITE_ERROR": "Error writing to GUI pipe: {}",
            "SERVICE_CONNECTED_TO_GUI": "Service successfully connected to GUI",

            # daemonservice
            "DAEMON_SVC_STOPPING": "Stopping daemon service...",
            "DAEMON_SVC_STARTED": "Daemon service started running",
            "MAIN_SVC_RESTART_ATTEMPT": "Main service has been stopped, attempting restart",
            "MAIN_SVC_RESTARTED": "Main service has been restarted",
            "FILE_DELETED": "File deleted: {}",
            "FILE_DELETE_ERROR": "Error deleting file: {}",
            "MAIN_SVC_CONFIG_ERROR": "Failed to get main service configuration: {}",
            "PROXY_SETTINGS_CHANGED": "Proxy settings change detected, new value: {}",
            "PROXY_CORRECTION_ERROR": "Error correcting proxy settings: {}",
            # 新增：用户注册表监控相关日志
            "MONITOR_STATUS": "Current monitored users: {}, new users: {}, removed users: {}",
            "USER_MONITOR_ADDED": "Started monitoring user: {}, SID: {}",
            "USER_MONITOR_REMOVED": "Stopped monitoring user: {}, SID: {}",
            "USER_SCANNER_ERROR": "Error occurred during user scan: {}",
            "ADD_MONITOR_ERROR": "Error adding monitor for user {}: {}",
            "REMOVE_MONITOR_ERROR": "Error removing monitor for SID {}: {}",
            "REGISTRY_CHECK_ERROR": "Error checking registry for SID {}: {}",
            "USER_PROCESS_ERROR": "Error processing user {}: {}",
            "USER_ENUM_ERROR": "Error enumerating users: {}",
            
            # ProxyConfig
            'proxy_tool_intro': "Proxy Configuration Tool\nUse help or ? to view help\nUse Tab key to auto-complete commands and parameters",
            'port_required': "Please specify the port number",
            'port_invalid': "Invalid port number, must be numeric",
            'port_out_range': "Port {} is not in range 49152 to 65535",
            'port_in_use': "Port {} is already in use",
            'port_set': "Proxy port has been set to: {}",
            'operation_required': "Please specify operation type",
            'upstream_not_set': "Upstream proxy server not set, please set server address first",
            'upstream_enabled': "Upstream proxy enabled",
            'upstream_disabled': "Upstream proxy disabled",
            'upstream_invalid': "Invalid upstream proxy format, please use 'http://ip:port' or 'https://ip:port' format",
            'upstream_set': "Upstream proxy server has been set to: {} and enabled",
            'upstream_cmd_invalid': "Invalid upstream command, please use enable, disable or enter proxy server address",
            'mitmlog_required': "Please specify enable or disable",
            'mitmlog_enabled': "mitmproxy logging enabled",
            'mitmlog_disabled': "mitmproxy logging disabled",
            'mitmlog_cmd_invalid': "Invalid mitmlog command, please use enable or disable",
            'option_required': "Please specify option and value",
            'option_invalid': "Invalid input, must contain =",
            'type_error': "Disable setting",
            'option_set': "Set {} = {}",
            'option_name_required': "Please specify the option name to delete",
            'delopt_error': "Deletion Disabled",
            'option_deleted': "Option {} has been deleted",
            'option_not_found': "Option {} not found",
            'config_not_found': "Setting not found: {}",
            'all_configs': "All configurations:",
            'restart_sent': "Restart command sent",
            'restart_error': "{}Please confirm if proxy service is running",
            'unknown_command': "Unknown command: '{}'",
            'no_help_doc': "Command '{}' has no help documentation",
            'available_commands': "\nAvailable commands:",
            'help_port': "Set proxy port <port_number> (range: 49152-65535)",
            'help_upstream': "Upstream proxy settings: upstream enable | disable | http[s]://host:port",
            'help_mitmlog': "Enable/disable mitmproxy logging: mitmlog enable | disable",
            'help_setopt': "Set mitmproxy option: setopt <name>=<value>",
            'help_delopt': "Delete mitmproxy option: delopt <name>",
            'help_select': "Query configuration: select <name>",
            'help_restart': "Restart proxy service",
            'help_quit': "Exit program",
            'help_help': "View help",
            'help_batch': "Enable/disable batch processing: batch enable | disable",
            'batch_required': "Please specify enable or disable",
            'batch_enabled': "Batch processing enabled",
            'batch_disabled': "Batch processing disabled",
            'batch_cmd_invalid': "Invalid batch command, please use enable or disable",

            # installer
            'main_service': "main service",
            'daemon_service': "daemon service",
            'installer_running': "Installation is already running, please do not run repeatedly",
            'os_not_supported': "Operating system does not support automatic certificate installation.",
            'admin_required': "Administrator privileges required to install certificate.",
            'cert_installed': "Certificate is already installed, no need to reinstall.",
            'cert_install_success': "Windows certificate installation successful.",
            'cert_install_failed': "Windows certificate installation failed: {}",
            'permission_set_success': "Permission set successfully: {}",
            'permission_set_failed': "Permission set failed: {}, error: {}",
            'env_path_added': "Added {} to system environment variable PATH permanently.",
            'env_path_exists': "{} already exists in system environment variable PATH.",
            'env_path_failed': "Failed to add CONFIG_PATH to system environment variable: {}",
            'get_sid_failed': "Failed to get user SID: {}",
            'service_stopping': "Stopping {}...",
            'service_stopped': "{} has been stopped",
            'service_not_exist': "{} does not exist",
            'service_stop_timeout': "{} stop timeout",
            'service_stop_error': "Error waiting for service to stop: {}",
            'service_remove_success': "{} removed successfully",
            'service_remove_failed': "Service does not exist or failed to remove: {}",
            'service_removing': "Removing {}...",
            'service_start_success': "{} start successfully",
            'service_start_timeout': "Timeout starting {}",
            'service_register_success': "{} register successfully",
            'service_register_failed': "Failed to register {}: {}",
            "KEY_GEN_SUCCESS": "Key generation successful",
            "KEY_GEN_FAILED": "Key generation failed: {}",
            "INSTALL_START": "===============install start===============",
            "INSTALL_END": "===============install end===============",

            # uninstaller
            "PARENT_PROCESS_INFO": "Parent process: {}, status: {}",
            "VALIDATION_RESULT": "Validation result: {}",

            # detect
            'predict_result': "result：{}, {}",
            'ONNX_runtime_error': "ONNX runtime error: {}",
            'cache_hit': "Image cache hit: {}",
            'GIF_PROCESS_ERROR': "Error processing GIF image: {}",
            # stream
            'VIDEO_STREAM_INTERCEPTED': "Video stream intercepted: {}",
            'VIDEO_STREAM_ERROR': "Error processing video stream: {}",

            # blacklist
            'BLACKLIST_CACHE_INIT': "Blacklist cache initialized with {} entries",
            'BLACKLIST_CACHE_REFRESH': "Blacklist cache refreshed with {} entries",
            'BLACKLIST_CACHE_ERROR': "Error managing blacklist cache: {}",
            'BLACKLIST_ADD_ERROR': "Error adding domain to blacklist: {}",

            

            # proxy
            "FINAL_STATS": "\n=== Final Stats for {} ===",
            "TOTAL_IMG": "Total images: {}",
            "PROBLEM_IMG": "Problematic images: {}",
            "PROBLEM_RATIO": "Ratio of problematic images: {:.2%}\n",
            "BLACKLIST_URL_INTERCEPTED": "Intercepted blacklisted URL request: {}",
            "STREAM_DATA_DETECTED": "Streaming data detected: {}",
            "SVG_IMAGE_SKIPPED": "SVG image processing skipped: {}",
            "IMAGE_URL_INTERCEPTED": "Image interception URL: {}, Referer: {}",
            "IMAGE_PROCESS_TIMEOUT": "Image processing timeout: {}",
            "UNRECOGNIZED_IMAGE": "Unrecognized image file: {}",
            "IMAGE_PROCESS_ERROR": "Error occurred while processing image: {}",
            "DOMAIN_BLACKLISTED": "Domain {} has been added to blacklist.\n",
            "PROXY_SERVICE_STOPPED": "Proxy service stopped, resources cleaned up",
            "START_FORBID": "Strictly forbidden! Dangerous visits: {}, forbidden mode: {}, duration: {}min",
            "RESET_FORBID": "Forbid mode '{}' has been reset",
            "ACTIVE_FORBID_FOUND": "Active forbid event found. Mode: {}, remaining time: {}min",
            "FORBID_EVENT_CHECK_ERROR": "Error checking forbid events: {}",
            "BLACKLIST_CACHE_REFRESH_PAUSED": "Blacklist cache refresh has been paused",
            "BLACKLIST_CACHE_REFRESH_RESUMED": "Blacklist cache refresh has been resumed",
            "SENSITIVE_SEARCH_BLOCKED": "sensitive search blocked",

            # monitor
            "START_REGISTRY_MONITORING": "Start monitoring {}",
            "REGISTRY_OPEN_ERROR": "Cannot open registry key: {}, error: {}",
            "UNHANDLED_REGISTRY_TYPE": "Unhandled registry type: {} for value: {}",
            "REGISTRY_READ_ERROR": "Cannot read registry value: {}, error: {}",
            "REGISTRY_NOTIFY_ERROR": "Cannot set registry notification",
            "STOP_SIGNAL_RECEIVED": "Stop signal received",
            "EVENT_WAIT_ERROR": "Error occurred while waiting for event: {}",
            "REGISTRY_MONITORING_ENDED": "{} monitoring ended",

            

            

            # configuration management
            
            "INIT_FAILURE": "Service initialization failed: {}",

            # New category titles
            'category_proxy_settings': "Proxy Settings",
            'category_config_management': "Configuration Management",
            'category_system_operations': "System Operations",
            'error_generic': "Error: {}",
            'config_value_display': "{}: {}",
            'goodbye': "Goodbye!",
            'thread_start_error': "Error starting thread: {}",
            'thread_stop_error': "Error stopping thread: {}",
            'thread_started': "Thread started: {}",
            'thread_stopped': "Thread stopped: {}",
            'daemon_thread_start_error': "Error starting daemon thread: {}",
            'daemon_thread_stop_error': "Error stopping daemon thread: {}",
            'daemon_init_error': "Error initializing daemon service: {}",
            'daemon_main_loop_error': "Error in daemon service main loop: {}",
            'daemon_config_get_error': "Error getting configuration: {}",
            
            # AI检测相关
            'memory_high_cleanup': "Memory usage is critically high at {}%, performed emergency resource cleanup based on {}",
            'memory_medium_cleanup': "Memory usage is high at {}%, cleaned up partial cache based on {}",
            'inactive_session_released': "Released inactive model session for thread {}",
            'image_processing_timeout': "Image processing timeout (hash: {}), considered harmful content for security reasons",
            'batch_config_error': "Error reading batch config: {}",
            'batch_update_error': "Error updating batch config: {}",
            'batch_processing_error': "Error in batch processing: {}",
            
            # GUI相关
            'pipe_created': "Pipe created successfully.",
            'pipe_create_error': "Failed to create pipe: {}",
            'listening_messages': "Listening for messages...",
            'client_connected': "Client connected",
            'pipe_read_error': "Error reading from pipe: {}",
            'pipe_connect_error': "Error connecting to pipe: {}",
            'pipe_closed': "Pipe connection closed.",
            
            # 日志管理相关
            'check_rotate_error': "Check rotate error: {}",
            'move_file': "Move {} to {}",
            'move_file_error': "Move file error: {}",
            'log_exception': "Exception occurred: {}",
            'removed_archive': "Removed old archive directory: {}",
            'remove_dir_error': "Failed to remove directory {}: {}",
            'cleanup_archives_error': "Error in cleanup_old_archives: {}",
        },
        'zh_CN': {
            # proxy config
            'proxy_tool_intro': "代理配置工具\n使用 help 或 ? 查看帮助\n使用 Tab 键自动补全命令和参数",
            'port_required': "请指定端口号",
            'port_invalid': "无效的端口号，必须为数字",
            'port_out_range': "端口号 {} 不在范围 49152 到 65535 之间",
            'port_in_use': "端口 {} 已被占用",
            'port_set': "代理端口已设置为: {}",
            'operation_required': "请指定操作类型",
            'upstream_not_set': "上游代理服务未设置，请先设置上游代理服务器地址",
            'upstream_enabled': "上游代理已启用",
            'upstream_disabled': "上游代理已禁用",
            'upstream_invalid': "无效的上游代理服务格式，请使用 'http://ip:port' 或 'https://ip:port' 格式",
            'upstream_set': "上游代理服务已设置为: {} 并已启用",
            'upstream_cmd_invalid': "无效的upstream命令，请使用 enable、disable 或输入代理服务器地址",
            'mitmlog_required': "请指定启用或禁用",
            'mitmlog_enabled': "mitmproxy日志已启用",
            'mitmlog_disabled': "mitmproxy日志已禁用",
            'mitmlog_cmd_invalid': "无效的mitmlog命令，请使用 enable 或 disable",
            'option_required': "请指定配置项和值",
            'option_invalid': "无效的输入，必须包含=",
            'type_error': "禁止设置",
            'option_set': "设置 {} = {}",
            'option_name_required': "请指定要删除的配置项名称",
            'delopt_error': "禁止删除",
            'option_deleted': "配置项 {} 已删除",
            'option_not_found': "未找到配置项 {}",
            'config_not_found': "未找到设置: {}",
            'all_configs': "所有配置:",
            'restart_sent': "已发送重启命令",
            'restart_error': "{}请确认代理服务是否启动",
            'unknown_command': "未知命令: '{}'",
            'no_help_doc': "命令 '{}' 没有帮助文档",
            'available_commands': "\n可用命令:",
            'help_port': "设置代理端口 port <port_number> 端口范围: 49152-65535",
            'help_upstream': "上游代理设置 upstream enable(启用) | disable(禁用) | http[s]://host:port(设置上游代理服务器)",
            'help_mitmlog': "是否开启mitmproxy日志输出 mitmlog enable(启用) | disable(禁用)",
            'help_setopt': "设置mitmproxy配置项 setopt <name>=<value>",
            'help_delopt': "删除mitmproxy配置项 delopt <name>",
            'help_select': "查询配置 select <name>",
            'help_restart': "重启代理服务",
            'help_quit': "退出程序",
            'help_help': "显示帮助信息",
            'help_batch': "批量处理设置 batch enable(启用) | disable(禁用)",
            'batch_required': "请指定启用或禁用",
            'batch_enabled': "批量处理已启用",
            'batch_disabled': "批量处理已禁用",
            'batch_cmd_invalid': "无效的batch命令，请使用 enable 或 disable",

            # installer
            'main_service': "主服务",
            'daemon_service': "守护服务",
            'installer_running': "安装程序正在执行中，请勿重复运行",
            'os_not_supported': "不支持自动安装证书的操作系统。",
            'admin_required': "需要管理员权限才能安装证书。",
            'cert_installed': "证书已安装，无需重复安装。",
            'cert_install_success': "Windows系统证书安装成功。",
            'cert_install_failed': "Windows系统证书安装失败: {}",
            'permission_set_success': "设置权限成功: {}",
            'permission_set_failed': "设置权限失败: {}, 错误信息: {}",
            'env_path_added': "已将 {} 永久添加到系统环境变量 PATH 中。",
            'env_path_exists': "{} 已存在于系统环境变量 PATH 中。",
            'env_path_failed': "添加 CONFIG_PATH 到系统环境变量失败: {}",
            'get_sid_failed': "获取用户 SID 失败: {}",
            'service_stopping': "正在停止{}...",
            'service_stopped': "{} 已停止",
            'service_not_exist': "{} 不存在",
            'service_stop_timeout': "停止{}超时",
            'service_stop_error': "等待服务停止时出错: {}",
            'service_remove_success': "{} 移除成功",
            'service_remove_failed': "服务不存在或移除失败: {}",
            'service_removing': "正在删除{}...",
            'service_start_success': "{}启动成功",
            'service_start_timeout': "{}启动超时",
            'service_register_success': "注册{}成功",
            'service_register_failed': "注册{}失败: {}",
            "KEY_GEN_SUCCESS": "生成密钥成功",
            "KEY_GEN_FAILED": "生成密钥失败: {}",
            "INSTALL_START": "===============安装开始===============",
            "INSTALL_END": "===============安装结束===============",

            # detect
            'predict_result': "预测结果：{}, {}",
            'ONNX_runtime_error': "ONNX运行时错误: {}",
            'cache_hit': "图像缓存命中: {}",
            'GIF_PROCESS_ERROR': "处理GIF图像时发生错误: {}",

            # stream
            'VIDEO_STREAM_INTERCEPTED': "视频流已拦截: {}",
            'VIDEO_STREAM_ERROR': "处理视频流时发生错误: {}",

            # blacklist
            'BLACKLIST_CACHE_INIT': "黑名单缓存已初始化，包含 {} 个条目",
            'BLACKLIST_CACHE_REFRESH': "黑名单缓存已刷新，包含 {} 个条目",
            'BLACKLIST_CACHE_ERROR': "黑名单缓存管理错误: {}",
            'BLACKLIST_ADD_ERROR': "添加域名到黑名单时出错: {}",

            # uninstaller
            "PARENT_PROCESS_INFO": "父进程：{}，状态：{}",
            "VALIDATION_RESULT": "验证结果：{}",

            # mainservice
            "MAIN_SVC_START": "主服务正在启动",
            "MITMPROXY_TERMINATED": "mitmproxy代理进程终止，正在重启",
            "SVC_STOP_SIGNAL": "收到停止服务信号",
            "ILLEGAL_STOP": "非法停止",
            "MAIN_SVC_STOPPING": "正在停止主服务...",
            "SVC_SETTINGS_CHANGED": "检测到服务设置变化，新值: {}",
            "KEY_TAMPERED": "{} 被篡改，正在修正...",
            "KEY_CORRECTED": "{} 修正完成",
            "SVC_CORRECTION_ERROR": "修正服务设置出错: {}",
            "FORCE_CONFIG_REFRESH_FAIL": "强制刷新服务配置失败: {}",
            "SERVICE_RECOVERY_SUCCESS": "服务恢复选项设置成功",
            "DAEMON_CONFIG_FAIL": "获取守护服务配置失败: {}",
            "SOCKET_LISTEN_START": "启动socket监听线程",
            "MITMPROXY_RESTART": "收到重启命令, 重启 mitmproxy",
            "REMOTE_CONN_CLOSED": "远程连接关闭",
            "SOCKET_LISTEN_ERROR": "socket监听错误: {}",
            "SOCKET_THREAD_STOPPED": "socket监听线程已停止",
            "SOCKET_CLOSE_ERROR": "关闭socket时发生错误：{}",
            "SOCKET_STOP_ERROR": "停止socket监听时发生错误：{}",
            "PROXY_PORT_GET": "获取代理端口： {}",
            "PROXY_PORT_CHECK": "请先设置代理端口并检查是否可用",
            "UPSTREAM_PROXY_STATUS": "获取是否启用上游代理： {}",
            "ENABLE": "启用",
            "DISABLE": "禁用",
            "UPSTREAM_PROXY_ADDRESS": "获取上游代理服务地址： {}",
            "UPSTREAM_PROXY_REQUIRED": "请先设置上游代理服务地址",
            "PROXY_CONFIG_GET": "获取代理配置： {}",
            "PORT_AVAILABLE": "端口 {} 可用",
            "PORT_UNAVAILABLE": "端口 {} 不可用：{}",
            "WIN_PROXY_SET": "设置Windows代理: ProxyEnable = {}, ProxyServer = {}",
            "WIN_PROXY_ERROR": "设置Windows代理出错：{}",
            "EXECUTE_COMMAND": "执行命令：{}",
            "MITMDUMP_START_SUCCESS": "mitmdump 启动成功，端口： {}，上游代理： {}， 上游代理地址： {}",
            "MITMDUMP_START_FAIL": "mitmdump 启动失败",
            "COMMAND_EXEC_ERROR": "执行命令时发生错误: {}",
            "MITMPROXY_STOPPING": "停止mitmproxy进程...",
            "MITMPROXY_STOPPED": "mitmproxy进程和相关线程已停止",
            "PROCESS_NOT_STOPPED": "{}未停止",
            "TERMINATE_PROCESS": "终止进程: {} (PID: {})",
            "MITMPROXY_TERM_ERROR": "终止mitmproxy进程错误：{}",
            "ERROR": "发生错误：{}",
            "DAEMON_SVC_RESTART_ATTEMPT": "守护服务已被停止，尝试重启",
            "DAEMON_SVC_RESTARTED": "守护服务已重启",
            "MONITOR_DAEMON_END": "监控守护服务线程停止",
            "SYSTEM_SHUTDOWN_WARNING": "系统正在关机",
            "SUCCESS_LAUNCHED": "启动GUI进程, PID: {}",
            "NO_USER_CONTEXT": "当前会话未找到用户进程",
            "FAILED_LAUNCH": "启动GUI进程失败: {}",
            "FAILED_USER_CONTEXT": "获取用户进程PID失败: {}",
            

            # 中文翻译
            'GUI_LAUNCH_FAILED_RETRY': "GUI启动失败，正在进行第{}/{}次重试",
            'PIPE_CONNECT_TIMEOUT': "连接GUI管道超时",
            'GUI_PIPE_ABANDONED': "达到最大重试次数后，放弃GUI管道连接",
            'GUI_PIPE_ERROR': "GUI管道管理错误: {}",
            'GUI_PIPE_WRITE_ERROR': "向GUI管道写入数据时出错: {}",
            'SERVICE_CONNECTED_TO_GUI': "服务成功连接到GUI",

            # daemonservice
            "DAEMON_SVC_STOPPING": "正在停止守护服务...",
            "DAEMON_SVC_STARTED": "守护服务开始运行",
            "MAIN_SVC_RESTART_ATTEMPT": "主服务已停止，尝试重启",
            "MAIN_SVC_RESTARTED": "主服务已被重启",
            "FILE_DELETED": "已删除文件: {}",
            "FILE_DELETE_ERROR": "删除文件时出错: {}",
            "MAIN_SVC_CONFIG_ERROR": "获取主服务配置失败: {}",
            "PROXY_SETTINGS_CHANGED": "检测到代理设置变化，新值: {}",
            "PROXY_CORRECTION_ERROR": "修正代理设置出错: {}",
            # 新增：用户注册表监控相关日志
            "MONITOR_STATUS": "当前监控用户数: {}，新增用户: {}，移除用户: {}",
            "USER_MONITOR_ADDED": "已开始监控用户: {}, SID: {}",
            "USER_MONITOR_REMOVED": "已停止监控用户: {}, SID: {}",
            "USER_SCANNER_ERROR": "用户扫描过程中发生错误: {}",
            "ADD_MONITOR_ERROR": "添加用户 {} 的监控时出错: {}",
            "REMOVE_MONITOR_ERROR": "移除SID为 {} 的用户监控时出错: {}",
            "REGISTRY_CHECK_ERROR": "检查SID为 {} 的注册表时出错: {}",
            "USER_PROCESS_ERROR": "处理用户 {} 时出错: {}",
            "USER_ENUM_ERROR": "枚举用户时出错: {}",

            # proxy
            "FINAL_STATS": "\n=== {} 最终结果 ===",
            "TOTAL_IMG": "图像总数: {}",
            "PROBLEM_IMG": "问题图象数: {}",
            "PROBLEM_RATIO": "问题图像占比: {:.2%}\n",
            "BLACKLIST_URL_INTERCEPTED": "拦截黑名单 URL 请求: {}",
            "STREAM_DATA_DETECTED": "检测到流式数据: {}",
            "SVG_IMAGE_SKIPPED": "SVG 图像跳过处理: {}",
            "IMAGE_URL_INTERCEPTED": "图片拦截url：{}, Referer: {}",
            "IMAGE_PROCESS_TIMEOUT": "图像处理超时: {}",
            "UNRECOGNIZED_IMAGE": "无法识别的图像文件: {}",
            "IMAGE_PROCESS_ERROR": "处理图像时发生错误: {}",
            "DOMAIN_BLACKLISTED": "域名 {} 已添加到黑名单。\n",
            "PROXY_SERVICE_STOPPED": "代理服务已停止，资源已清理",
            "START_FORBID": "严格禁止！危险访问：{}次，禁止模式：{}，持续时间：{}分钟",
            "RESET_FORBID": "禁止模式 '{}' 已重置",
            "ACTIVE_FORBID_FOUND": "发现活跃的禁止事件。模式：{}，剩余时间：{}分钟",
            "FORBID_EVENT_CHECK_ERROR": "检查禁止事件时出错：{}",
            "BLACKLIST_CACHE_REFRESH_PAUSED": "黑名单缓存刷新已暂停",
            "BLACKLIST_CACHE_REFRESH_RESUMED": "黑名单缓存刷新已恢复",
            "SENSITIVE_SEARCH_BLOCKED": "敏感词拦截",

            # monitor
            "START_REGISTRY_MONITORING": "开始监听 {}",
            "REGISTRY_OPEN_ERROR": "无法打开注册表项: {}, 错误: {}",
            "UNHANDLED_REGISTRY_TYPE": "未处理的注册表类型: {} 对于值: {}",
            "REGISTRY_READ_ERROR": "无法读取注册表值: {}, 错误: {}",
            "REGISTRY_NOTIFY_ERROR": "无法设置注册表通知",
            "STOP_SIGNAL_RECEIVED": "收到停止信号",
            "EVENT_WAIT_ERROR": "等待事件时发生错误: {}",
            "REGISTRY_MONITORING_ENDED": "{} 监听结束",

            # thread and process management
            "THREAD_STOP_TIMEOUT": "线程 {} 未能在超时时间内终止",
            "MAX_WAIT_EXCEEDED": "获取用户PID时超过最大等待时间(10分钟)",
            "FORCE_KILL_PROCESS": "超时后强制终止mitmproxy进程",
            "SESSION_NOT_ACTIVE": "进程ID {} 不是活动会话",
            "THREAD_STARTED": "线程 {} 已启动",

            # pipe management
            "PIPE_CREATED": "命名管道创建成功",
            "WAITING_FOR_PIPE": "等待GUI管道可用",
            "PIPE_CREATE_ERROR": "创建管道错误: {}",
            "GUI_PIPE_CLOSED": "GUI管道已成功关闭",
            "GUI_PIPE_CLOSE_ERROR": "关闭GUI管道时出错: {}",
            "GUI_PROCESS_CLOSED": "GUI进程已成功关闭",
            "GUI_PROCESS_CLOSE_ERROR": "关闭GUI进程时出错: {}",

            # configuration management
            "CONFIG_CONVERT_ERROR": "转换配置项 {} 失败: {}",
            "INIT_FAILURE": "服务初始化失败: {}",

            # New category titles
            'category_proxy_settings': "代理设置",
            'category_config_management': "配置管理",
            'category_system_operations': "系统操作",
            'error_generic': "错误: {}",
            'config_value_display': "{}: {}",
            'goodbye': "再见！",
            'thread_start_error': "启动线程错误: {}",
            'thread_stop_error': "停止线程错误: {}",
            'thread_started': "线程已启动: {}",
            'thread_stopped': "线程已停止: {}",
            'daemon_thread_start_error': "启动守护服务线程错误: {}",
            'daemon_thread_stop_error': "停止守护服务线程错误: {}",
            'daemon_init_error': "初始化守护服务错误: {}",
            'daemon_main_loop_error': "守护服务主循环错误: {}",
            'daemon_config_get_error': "获取配置错误: {}",
            
            # AI检测相关
            'memory_high_cleanup': "内存使用率高达 {}%，基于{}已执行紧急资源释放",
            'memory_medium_cleanup': "内存使用率 {}%，基于{}已清理部分缓存",
            'inactive_session_released': "释放线程 {} 的不活跃模型会话",
            'image_processing_timeout': "图像处理超时 (哈希值: {}), 出于安全考虑将其视为有害内容",
            'batch_config_error': "读取批处理配置时出错: {}",
            'batch_update_error': "更新批处理配置时出错: {}",
            'batch_processing_error': "批处理过程中出错: {}",
            
            # GUI相关
            'pipe_created': "管道创建成功。",
            'pipe_create_error': "创建管道失败: {}",
            'listening_messages': "正在监听消息...",
            'client_connected': "客户端已连接",
            'pipe_read_error': "从管道读取数据时出错: {}",
            'pipe_connect_error': "连接管道时出错: {}",
            'pipe_closed': "管道连接已关闭。",
            
            # 日志管理相关
            'check_rotate_error': "检查日志轮转时出错: {}",
            'move_file': "移动 {} 到 {}",
            'move_file_error': "移动文件时出错: {}",
            'log_exception': "发生异常: {}",
            'removed_archive': "已删除旧归档目录: {}",
            'remove_dir_error': "删除目录 {} 失败: {}",
            'cleanup_archives_error': "清理旧归档时出错: {}",
        }
    }